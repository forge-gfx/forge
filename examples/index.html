<!DOCTYPE html>
<html>
    <head>
        <title>Forge â€¢ Examples</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap');

            :root {
                --panel-width: 300px;
                --border-style: 4px solid #ab2f3b;
            }

            @media screen and (max-width: 768px) {
                #panel {
                    display: none !important;
                }

                #mobile-header {
                    display: flex !important;
                    justify-content: space-between;
                    align-items: center;
                    padding: 1rem;
                    background: #D43E4C;
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    z-index: 1000;
                    height: 2rem;
                }

                #content {
                    margin: 0 m !important;
                    padding-top: 4rem !important;
                    width: 100% !important;
                    height: calc(100vh - 4rem) !important;
                }

                #panel.mobile {
                    display: flex;
                    position: fixed;
                    top: 0;
                    right: -100%;
                    left: auto;
                    width: 80%;
                    height: 100%;
                    transform: none;
                    transition: right 0.3s ease-in-out;
                    z-index: 1001;
                    background: #D43E4C;
                }

                #panel.mobile.active {
                    right: 0;
                }

                #header {
                    display: none;
                }

                #overlay {
                    display: none;
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.5);
                    z-index: 1000;
                }

                #overlay.active {
                    display: block;
                }
            }

            body {
                margin: 0;
                padding: 0;
                font-family: "Inter", sans-serif;
                font-weight: 300;
            }

            #panel {
                position: fixed;
                z-index: 100;
                left: 0px;
                width: var(--panel-width);
                height: 100%;
                overflow: auto;
                border-right: var(--border-style);
                display: flex;
                flex-direction: column;
                transition: 0s 0s height;
                background: #D43E4C;
            }

            hr {
                height: 1px;
                color: #ab2f3b;
                background: #ab2f3b;
                font-size: 0;
                border: 0;
            }

            #content {
                margin-left: var(--panel-width);
                width: calc(100% - var(--panel-width));
                height: 100vh;
            }

            #content iframe {
                width: 100%;
                height: 100%;
                border: none;
            }

            #header {
                display: flex;
                height: 4rem;
                align-items: center;
                justify-content: center;
                padding: 0 1rem;
            }

            #header .logo {
                height: 1.25rem;
                margin-right: 1rem;
            }

            #header .title {
                color: white;
                font-size: 1.0rem;
                text-transform: uppercase;
                letter-spacing: 0.04rem;
            }

            #header a, #mobile-header a {
                display: flex;
                align-items: center;
                text-decoration: none;
            }

            #header a .logo, #mobile-header a .logo {
                height: 1.25rem;
                margin-right: 1rem;
                display: block;
            }

            #code-button {
                position: fixed;
                bottom: 16px;
                right: 16px;
                padding: 12px;
                border-radius: 50%;
                margin-bottom: 0px;
                background-color: #D43E4C;
                opacity: .9;
                z-index: 999;
                box-shadow: 0 0 4px rgba(0, 0, 0, .15);
            }

            .example-link {
                display: block;
                font-size: 0.8rem;
                padding: 10px 15px;
                text-decoration: none;
                color: #ffffff;
            }

            .example-link:hover {
                background-color: rgba(0, 0, 0, 0.15);
            }

            .example-link.active {
                background-color: rgba(0, 0, 0, 0.15);
                border-left: 4px solid #ffffff;
            }

            #mobile-header {
                display: none;
            }
        </style>
        <script>
            async function loadExamples() {
                try {
                    const res = await fetch('examples.json');
                    const data = await res.json();
                    const panel = document.getElementById('panel');

                    const existingLinks = panel.querySelectorAll('.example-link');
                    existingLinks.forEach(link => link.remove());

                    const codeButton = document.createElement('a');
                    codeButton.id = 'code-button';
                    codeButton.target = '_blank';
                    codeButton.title = 'View source code for this example on GitHub';
                    codeButton.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="display:block;">
                            <path fill="none" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 8l-4 4l4 4m6-8l4 4l-4 4"/>
                        </svg>
                    `;
                    document.body.appendChild(codeButton);

                    data.examples.forEach((example, index) => {
                        const link = document.createElement('a');
                        link.href = `#${example.path}`;
                        link.className = 'example-link';
                        link.textContent = example.name;

                        if (example.name === 'Hello World') {
                            link.classList.add('active');
                            const iframe = document.getElementById('example-frame');
                            iframe.src = example.path;
                            codeButton.href = example.source;
                        }

                        link.addEventListener('click', (e) => {
                            e.preventDefault();
                            const iframe = document.getElementById('example-frame');
                            iframe.src = example.path;

                            document.querySelectorAll('.example-link').forEach(l => l.classList.remove('active'));
                            link.classList.add('active');

                            codeButton.href = example.source;
                        });

                        panel.appendChild(link);
                    });
                } catch (error) {
                    console.error('Error loading examples:', error);
                }
            }

            document.addEventListener('DOMContentLoaded', loadExamples);

            function setupMobileMenu() {
                const hamburger = document.getElementById('hamburger');
                const panel = document.getElementById('panel');
                const overlay = document.getElementById('overlay');

                const mobilePanel = panel.cloneNode(true);
                mobilePanel.id = 'mobile-panel';
                mobilePanel.classList.add('mobile');
                document.body.appendChild(mobilePanel);

                function closeMenu() {
                    mobilePanel.classList.remove('active');
                    overlay.classList.remove('active');
                }

                function openMenu() {
                    mobilePanel.classList.add('active');
                    overlay.classList.add('active');
                }

                hamburger.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (mobilePanel.classList.contains('active')) {
                        closeMenu();
                    } else {
                        openMenu();
                    }
                });

                overlay.addEventListener('click', closeMenu);

                mobilePanel.querySelectorAll('.example-link').forEach(link => {
                    link.addEventListener('click', () => {
                        closeMenu();
                    });
                });

                mobilePanel.addEventListener('click', (e) => {
                    e.stopPropagation();
                });
            }

            document.addEventListener('DOMContentLoaded', () => {
                loadExamples();
                setupMobileMenu();
            });

            // function checkMobileView() {
            //     const isMobile = window.matchMedia("(max-width: 768px)").matches;
            //     console.log('Is mobile view:', isMobile);
            //     console.log('Mobile header display:', window.getComputedStyle(document.getElementById('mobile-header')).display);
            // }

            // window.addEventListener('load', checkMobileView);
            // window.addEventListener('resize', checkMobileView);

            // const mediaQuery = window.matchMedia("(max-width: 768px)");
            // mediaQuery.addListener((e) => {
            //     if (e.matches) {
            //         document.getElementById('mobile-header').style.display = 'flex';
            //         document.getElementById('panel').style.display = 'none';
            //     }
            // })
        </script>
    </head>
    <body>
        <div id="overlay"></div>
        <div id="mobile-header">
            <a href="https://forge.dev/">
                <img src="../docs/assets/images/logo.svg" alt="Forge" class="logo" />
            </a>
            <div id="hamburger">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 12H21" stroke="white" stroke-width="2" stroke-linecap="round"/>
                    <path d="M3 6H21" stroke="white" stroke-width="2" stroke-linecap="round"/>
                    <path d="M3 18H21" stroke="white" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </div>
        </div>
        <div id="panel">
            <div id="header">
                <a href="https://forge.dev/">
                    <img src="../docs/assets/images/logo.svg" alt="Forge" class="logo" />
                </a>
                <span class="title">EXAMPLES</span>
            </div>
            <hr />
        </div>
        <div id="content">
            <iframe id="example-frame" src=""></iframe>
        </div>
    </body>
</html>